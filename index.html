<!doctype html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TECOMï½œå¤–è³¼å“ç”¢å“ / å‚™å“æŸ¥è©¢ç³»çµ±ï¼ˆç¶­ä¿®äººå“¡å°ˆç”¨ï¼‰</title>

  <style>
    :root{
      --bg:#f6f8fc;
      --card:#ffffff;
      --line:#d7e2f3;
      --text:#0f172a;
      --muted:#5b6b85;

      --brand:#0b3a75;
      --brand-2:#0e4a92;
      --brand-3:#eaf2ff;
      --accent:#1b77ff;
      --danger:#c0262d;
      --ok:#0f766e;

      --radius:14px;
      --shadow: 0 10px 26px rgba(15, 23, 42, .08);
      --shadow2: 0 6px 16px rgba(15, 23, 42, .06);
      --font: "Microsoft JhengHei", system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans TC", Arial, sans-serif;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:var(--font);
      background:var(--bg);
      color:var(--text);
    }

    .topbar{
      background:linear-gradient(90deg, var(--brand), var(--brand-2));
      color:#fff;
      padding:18px 18px;
      position:sticky;
      top:0;
      z-index:10;
      box-shadow:0 4px 16px rgba(0,0,0,.12);
    }
    .topbar .wrap{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand-title{
      font-size:18px;
      font-weight:900;
      letter-spacing:.2px;
      line-height:1.25;
    }

    .page{
      max-width:1200px;
      margin:18px auto 18px;
      padding:0 18px;
      display:grid;
      grid-template-columns: 260px 1fr;
      gap:18px;
    }
    @media (max-width: 980px){
      .page{ grid-template-columns: 1fr; }
    }

    .sidebar{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow2);
      overflow:hidden;
    }

    .menu{
      padding:10px 8px 8px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .menu button{
      border:1px solid transparent;
      background:transparent;
      text-align:left;
      padding:10px 10px;
      border-radius:12px;
      cursor:pointer;
      color:var(--text);
      font-weight:800;
      font-size:14px;
      transition:.15s ease;
    }
    .menu button:hover{
      background:#f1f6ff;
      border-color:var(--line);
    }
    .menu button.active{
      background:linear-gradient(180deg, #eaf2ff, #ffffff);
      border-color:var(--line);
      color:var(--brand);
      box-shadow:0 2px 0 rgba(11,58,117,.08) inset;
    }

    .hint{
      padding:10px 14px 14px;
      color:var(--muted);
      font-size:12.5px;
      border-top:1px solid var(--line);
    }

    .main{
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card .bar{
      padding:14px 16px;
      background:linear-gradient(90deg, #0b3a75, #0e4a92);
      color:#fff;
      font-weight:900;
      letter-spacing:.3px;
    }
    .card .body{
      padding:16px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr auto;
      gap:10px;
      align-items:end;
    }
    @media (max-width: 760px){
      .grid{ grid-template-columns: 1fr; }
    }

    label{
      display:block;
      font-size:12.5px;
      color:var(--muted);
      margin-bottom:6px;
      font-weight:800;
    }
    input, select, textarea{
      width:100%;
      padding:11px 12px;
      border:1px solid var(--line);
      border-radius:12px;
      outline:none;
      font-size:14px;
      background:#fff;
      font-family:var(--font);
    }
    textarea{ min-height:92px; resize:vertical; }

    input:focus, select:focus, textarea:focus{
      border-color:#9dc0ff;
      box-shadow:0 0 0 4px rgba(27,119,255,.12);
    }

    .btn{
      padding:11px 14px;
      border-radius:12px;
      border:1px solid rgba(27,119,255,.35);
      background:linear-gradient(180deg, #2b86ff, #1b77ff);
      color:#fff;
      font-weight:900;
      cursor:pointer;
      transition:.12s ease;
      min-width:120px;
    }
    .btn:hover{ filter:brightness(1.02); }
    .btn:disabled{ opacity:.55; cursor:not-allowed; }

    .btn2{
      padding:11px 14px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--brand);
      font-weight:900;
      cursor:pointer;
      transition:.12s ease;
      min-width:120px;
    }
    .btn2:hover{ background:#f6f9ff; }

    .msg{
      margin-top:10px;
      font-size:13px;
      color:var(--muted);
      white-space:pre-wrap;
    }
    .msg.error{ color:var(--danger); font-weight:900; }
    .msg.ok{ color:var(--ok); font-weight:900; }

    .section-title{
      margin:12px 0 8px;
      font-weight:900;
      color:var(--brand);
      font-size:16px;
    }

    .kv{
      display:grid;
      grid-template-columns: 140px 1fr;
      gap:8px 12px;
      padding:12px;
      border:1px dashed #cfe0ff;
      background:#f7fbff;
      border-radius:12px;
      margin-top:10px;
      font-size:14px;
    }
    .kv .k{ color:var(--muted); font-weight:900; }
    .kv .v{ font-weight:900; }

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border:1px solid var(--line);
      border-radius:12px;
      background:#fff;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      font-size:13.5px;
      vertical-align:top;
    }
    th{
      background:#f2f7ff;
      color:var(--brand);
      font-weight:900;
      text-align:left;
    }
    tr:last-child td{ border-bottom:none; }

    .footer-note{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
    }

    .panel{ display:none; }
    .panel.active{ display:block; }

    /* thumbnails */
    .thumbs{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .thumb{
      width:86px; height:86px;
      border-radius:12px;
      border:1px solid var(--line);
      overflow:hidden;
      background:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 6px 16px rgba(15,23,42,.06);
    }
    .thumb img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-weight:900;
      font-size:12px;
      color:var(--brand);
    }

    .two-col{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width: 760px){
      .two-col{ grid-template-columns:1fr; }
    }
  </style>

  <script>
    // âœ… ä½ çš„ WebApp exec URLï¼ˆä¿ç•™ä½ ç›®å‰çš„ï¼‰
    const API_BASE = "https://script.google.com/macros/s/AKfycbyJOTLRM9JRKYYUH8KYmf6iWApHU31eI2alP1DAN8UhHIC74O9lKJtC8IemdIN7Md8DQA/exec";

    // âœ… ä½ æä¾›çš„å–®ä¸€ Drive è³‡æ–™å¤¾ï¼ˆä¸åˆ†å€ã€ä¸åˆ†å¹´åº¦ï¼‰
    const DRIVE_FOLDER_ID = "195CnV9weSPd8FzDjiljJTc8uheGHFTz9";

    // ä¸Šå‚³é™åˆ¶
    const MAX_PHOTOS = 5;
    const MAX_FILE_MB = 5;          // æ¯å€‹æª” <= 5MBï¼ˆç…§ç‰‡/å½±ç‰‡éƒ½å…ˆç”¨åŒä¸€æ¢è¦å‰‡æ§ï¼‰
    const MAX_VIDEO_SECONDS = 60;   // å½±ç‰‡ <= 60 ç§’

    /** JSONP helperï¼ˆé¿é–‹ CORSï¼Œç”¨æ–¼æŸ¥è©¢ï¼‰ */
    function jsonp(url){
      return new Promise((resolve, reject) => {
        const cbName = "cb_" + Math.random().toString(36).slice(2);
        const sep = url.includes("?") ? "&" : "?";
        const full = url + sep + "callback=" + cbName;

        const script = document.createElement("script");
        script.src = full;

        function cleanup(){
          try { delete window[cbName]; } catch(e){}
          script.remove();
        }

        script.onerror = () => { cleanup(); reject(new Error("JSONP load error")); };
        window[cbName] = (data) => { cleanup(); resolve(data); };

        document.body.appendChild(script);
      });
    }

    function qs(obj){
      const p = new URLSearchParams();
      Object.entries(obj).forEach(([k,v])=>{
        if (v !== undefined && v !== null && String(v).trim() !== "") p.append(k, v);
      });
      return p.toString();
    }

    function setMsg(panelId, type, text){
      const el = document.getElementById(panelId + "_msg");
      if (!el) return;
      el.className = "msg " + (type || "");
      el.textContent = text || "";
    }

    function esc(v){
      const s = String(v == null ? "" : v);
      return s.replace(/[&<>"']/g, c => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[c]));
    }

    function todayISO(){
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,"0");
      const dd = String(d.getDate()).padStart(2,"0");
      return `${y}-${m}-${dd}`;
    }

    function uuid(){
      return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, c => {
        const r = Math.random()*16|0;
        const v = c === "x" ? r : (r&0x3|0x8);
        return v.toString(16);
      });
    }

    // å½±ç‰‡é•·åº¦æª¢æŸ¥ï¼ˆ<= 60sï¼‰
    async function getVideoDurationSeconds(file){
      return new Promise((resolve, reject)=>{
        try{
          const url = URL.createObjectURL(file);
          const v = document.createElement("video");
          v.preload = "metadata";
          v.onloadedmetadata = () => {
            URL.revokeObjectURL(url);
            resolve(v.duration || 0);
          };
          v.onerror = () => {
            URL.revokeObjectURL(url);
            resolve(0); // è®€ä¸åˆ°å°±ç•¶ 0ï¼Œé¿å…æ“‹å¤ªæ­»
          };
          v.src = url;
        }catch(e){
          resolve(0);
        }
      });
    }

    // File -> base64 (dataUrl stripped)
    async function fileToBase64(file){
      return new Promise((resolve, reject)=>{
        const reader = new FileReader();
        reader.onload = ()=> {
          const s = String(reader.result || "");
          // data:xxx;base64,AAAA
          const idx = s.indexOf("base64,");
          const b64 = idx >= 0 ? s.slice(idx + 7) : s;
          resolve(b64);
        };
        reader.onerror = ()=> reject(new Error("FileReader error"));
        reader.readAsDataURL(file);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      // menu switch
      const menu = document.getElementById("menu");
      const buttons = Array.from(menu.querySelectorAll("button[data-panel]"));

      function activate(panelId) {
        buttons.forEach(b => b.classList.toggle("active", b.dataset.panel === panelId));
        document.querySelectorAll(".panel").forEach(p => p.classList.toggle("active", p.id === panelId));

        const btn = buttons.find(b => b.dataset.panel === panelId);
        const titleText = btn ? btn.textContent.trim() : "";

        const panelEl = document.getElementById(panelId);
        const barEl = panelEl ? panelEl.querySelector("[data-bar]") : null;
        if (barEl && titleText) barEl.textContent = titleText;

        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      buttons.forEach(btn => btn.addEventListener("click", () => activate(btn.dataset.panel)));

      const defaultPanel = (buttons.find(b => b.classList.contains("active")) || buttons[0])?.dataset.panel;
      if (defaultPanel) activate(defaultPanel);

      // init p3 date
      const p3_receive = document.getElementById("p3_receive_date");
      if (p3_receive) p3_receive.value = todayISO();
    });

    // ====== ê¸°ì¡´æŸ¥è©¢ï¼šp1 / p2 / p5 / p6 (ä¿ç•™ä½ åŸæœ¬) ======
    async function realSearch(panelId){
      try {
        setMsg(panelId, "", "æŸ¥è©¢ä¸­â€¦");

        if (panelId === "p1"){
          const code = document.getElementById("p1_code").value.trim();
          const model = document.getElementById("p1_model").value.trim();
          const url = API_BASE + "?" + qs({ action:"product_lookup", code, model });
          const res = await jsonp(url);

          if (!res.ok) throw new Error(res.msg || "API error");
          if (!res.product) { setMsg("p1", "error", res.msg || "æŸ¥ç„¡è³‡æ–™"); return; }

          const kv = document.getElementById("p1_kv").children;
          kv[1].textContent = res.product.product_code || "â€”";
          kv[3].textContent = res.product.model_no || "â€”";
          kv[5].textContent = res.product.vendor_code || "â€”";
          kv[7].textContent = res.product.name_zh || "â€”";
          kv[9].textContent = res.product.note || "â€”";

          const tbody = document.querySelector("#p1_tbl tbody");
          const items = Array.isArray(res.items) ? res.items : [];
          tbody.innerHTML = items.length ? items.map(it => `
            <tr>
              <td>${esc(it.item)}</td>
              <td>${esc(it.part_code)}</td>
              <td>${esc(it.part_model)}</td>
              <td>${esc(it.description)}</td>
              <td>${esc(it.note)}</td>
              <td>${esc(it.stock_qty)}</td>
            </tr>
          `).join("") : `<tr><td colspan="6" style="color:#5b6b85;">æŸ¥ç„¡ BOM/å‚™å“è³‡æ–™</td></tr>`;

          setMsg("p1", "ok", "æŸ¥è©¢å®Œæˆ");
          return;
        }

        if (panelId === "p2"){
          const sn = document.getElementById("p2_sn").value.trim();
          const mac = document.getElementById("p2_mac").value.trim();
          const url = API_BASE + "?" + qs({ action:"serial_lookup", sn, mac });
          const res = await jsonp(url);

          if (!res.ok) throw new Error(res.msg || "API error");
          if (!res.data){ setMsg("p2", "error", res.msg || "æŸ¥ç„¡è³‡æ–™"); return; }

          const kv = document.getElementById("p2_kv").children;
          kv[1].textContent  = res.data.serial_no || "â€”";
          kv[3].textContent  = res.data.model_no || "â€”";
          kv[5].textContent  = res.data.ship_date || "â€”";
          kv[7].textContent  = res.data.customer_name || "â€”";
          kv[9].textContent  = res.data.ship_doc_no || "â€”";
          kv[11].textContent = res.data.mac_addr || "â€”";
          kv[13].textContent = res.data.p2p_id || "â€”";

          setMsg("p2", "ok", "æŸ¥è©¢å®Œæˆ");
          return;
        }

        if (panelId === "p5"){
          const q = document.getElementById("p5_q").value.trim();
          const url = API_BASE + "?" + qs({ action:"camera_spare_lookup", q });
          const res = await jsonp(url);

          if (!res.ok) throw new Error(res.msg || "API error");

          const rows = Array.isArray(res.rows) ? res.rows : [];
          const tbody = document.querySelector("#p5_tbl tbody");
          tbody.innerHTML = rows.length
            ? rows.map(r => `
                <tr>
                  <td>${esc(r.camera)}</td>
                  <td>${esc(r.part_code)}</td>
                  <td>${esc(r.part_model)}</td>
                  <td>${esc(r.description)}</td>
                  <td>${esc(r.note)}</td>
                  <td>${esc(r.stock_qty)}</td>
                </tr>
              `).join("")
            : `<tr><td colspan="6" style="color:#5b6b85;">${esc(res.msg || "æŸ¥ç„¡è³‡æ–™")}</td></tr>`;

          setMsg("p5", rows.length ? "ok" : "error", rows.length ? "æŸ¥è©¢å®Œæˆ" : (res.msg || "æŸ¥ç„¡è³‡æ–™"));
          return;
        }

        if (panelId === "p6"){
          setMsg("p6","error","æ­¤ç‰ˆæœ¬å…ˆä¸æ”¹ p6ï¼ˆå‚™å“å…¥åº«ï¼‰ï¼Œé¿å…è·Ÿ Repair ä¸Šå‚³æ··åœ¨åŒä¸€è¼ªæ¸¬è©¦ã€‚");
          return;
        }

        setMsg(panelId, "error", "æœªçŸ¥çš„ panelId");

      } catch (err) {
        setMsg(panelId, "error", "æŸ¥è©¢å¤±æ•—ï¼š" + (err && err.message ? err.message : String(err)));
      }
    }

    // ====== p3ï¼šç¶­ä¿®å›å ±ï¼ˆå«ä¸Šå‚³ï¼‰=====
    async function p3LookupModel(){
      const code = document.getElementById("p3_product_code").value.trim();
      if (!code) return;

      try{
        setMsg("p3","", "æŸ¥è©¢å‹è™Ÿä¸­â€¦");
        const url = API_BASE + "?" + qs({ action:"product_lookup", code });
        const res = await jsonp(url);
        if (!res.ok) throw new Error(res.msg || "API error");

        const model = (res.product && res.product.model_no) ? res.product.model_no : "";
        document.getElementById("p3_model_no").value = model || "";
        setMsg("p3","ok", model ? "å·²å¸¶å‡ºå‹è™Ÿ" : "æŸ¥åˆ°æ–™è™Ÿï¼Œä½†å‹è™Ÿæ¬„ä½ç‚ºç©ºï¼ˆè«‹ç¢ºèª ProductMasterï¼‰");
      }catch(err){
        setMsg("p3","error","å‹è™Ÿå¸¶å‡ºå¤±æ•—ï¼š" + (err.message || err));
      }
    }

    function p3Clear(){
      document.getElementById("p3_item_type").value = "NVR";
      document.getElementById("p3_product_code").value = "";
      document.getElementById("p3_model_no").value = "";
      document.getElementById("p3_serial_no").value = "";
      document.getElementById("p3_repair_no").value = "";
      document.getElementById("p3_customer").value = "";
      document.getElementById("p3_issue").value = "";
      document.getElementById("p3_action").value = "";
      document.getElementById("p3_region").value = "åŒ—";
      document.getElementById("p3_engineer").value = "æ°¸å¯Œ";
      document.getElementById("p3_receive_date").value = todayISO();
      document.getElementById("p3_ship_date").value = "";
      document.getElementById("p3_status").value = "OPEN";
      document.getElementById("p3_files").value = "";
      document.getElementById("p3_preview").innerHTML = "";
      setMsg("p3","", "å·²æ¸…ç©ºè¡¨å–®");
    }

    async function p3PreviewFiles(){
      const el = document.getElementById("p3_files");
      const files = Array.from(el.files || []);
      const box = document.getElementById("p3_preview");
      box.innerHTML = "";

      if (!files.length) return;

      const images = files.filter(f => f.type.startsWith("image/"));
      const videos = files.filter(f => f.type.startsWith("video/"));

      // é™åˆ¶ï¼šç…§ç‰‡æœ€å¤š 5 å¼µï¼›å½±ç‰‡æœ€å¤š 1 æ®µ
      if (images.length > MAX_PHOTOS){
        setMsg("p3","error", `ç…§ç‰‡æœ€å¤š ${MAX_PHOTOS} å¼µï¼Œè«‹é‡æ–°é¸æ“‡`);
        el.value = "";
        return;
      }
      if (videos.length > 1){
        setMsg("p3","error", "å½±ç‰‡æœ€å¤š 1 æ®µï¼Œè«‹é‡æ–°é¸æ“‡");
        el.value = "";
        return;
      }

      // å¤§å°é™åˆ¶
      const tooBig = files.find(f => (f.size / 1024 / 1024) > MAX_FILE_MB);
      if (tooBig){
        setMsg("p3","error", `å–®ä¸€æª”æ¡ˆä¸å¯è¶…é ${MAX_FILE_MB}MBï¼š${tooBig.name}`);
        el.value = "";
        return;
      }

      // å½±ç‰‡é•·åº¦é™åˆ¶ï¼ˆ<= 60sï¼‰
      if (videos.length === 1){
        setMsg("p3","", "æª¢æŸ¥å½±ç‰‡é•·åº¦ä¸­â€¦");
        const dur = await getVideoDurationSeconds(videos[0]);
        if (dur && dur > MAX_VIDEO_SECONDS){
          setMsg("p3","error", `å½±ç‰‡éœ€å°æ–¼ ${MAX_VIDEO_SECONDS} ç§’ï¼ˆç›®å‰ç´„ ${Math.ceil(dur)} ç§’ï¼‰`);
          el.value = "";
          return;
        }
      }

      // preview thumbnails for images only
      images.forEach(f=>{
        const url = URL.createObjectURL(f);
        const div = document.createElement("div");
        div.className = "thumb";
        div.innerHTML = `<img src="${url}" alt="">`;
        box.appendChild(div);
      });

      if (videos.length === 1){
        const v = document.createElement("div");
        v.className = "pill";
        v.textContent = `å·²é¸å½±ç‰‡ï¼š${videos[0].name}`;
        box.appendChild(v);
      }

      setMsg("p3","ok", `å·²é¸æ“‡ï¼šç…§ç‰‡ ${images.length} å¼µ${videos.length? "ã€å½±ç‰‡ 1 æ®µ":""}`);
    }

    async function p3Submit(){
      try{
        setMsg("p3","", "é€å‡ºä¸­ï¼ˆå«ä¸Šå‚³æª”æ¡ˆï¼‰â€¦");

        const payload = {
          action: "repair_add",
          client_token: uuid(),
          drive_folder_id: DRIVE_FOLDER_ID,

          item_type: document.getElementById("p3_item_type").value,
          product_code: document.getElementById("p3_product_code").value.trim(),
          model_no: document.getElementById("p3_model_no").value.trim(),
          serial_no: document.getElementById("p3_serial_no").value.trim(),
          repair_no: document.getElementById("p3_repair_no").value.trim(),
          customer: document.getElementById("p3_customer").value.trim(),
          issue_desc: document.getElementById("p3_issue").value.trim(),
          repair_action: document.getElementById("p3_action").value.trim(),
          receive_date: document.getElementById("p3_receive_date").value,
          ship_back_date: document.getElementById("p3_ship_date").value,
          region: document.getElementById("p3_region").value,
          engineer: document.getElementById("p3_engineer").value,
          status: document.getElementById("p3_status").value
        };

        // basic validate
        if (!payload.product_code) { setMsg("p3","error","è«‹è¼¸å…¥æ–™è™Ÿï¼ˆå¿…å¡«ï¼‰"); return; }
        if (!payload.serial_no) { setMsg("p3","error","è«‹è¼¸å…¥åºè™Ÿï¼ˆå¿…å¡«ï¼‰"); return; }
        if (!payload.issue_desc) { setMsg("p3","error","è«‹è¼¸å…¥ç¶­ä¿®åŸå› èªªæ˜ï¼ˆå¿…å¡«ï¼‰"); return; }

        const files = Array.from(document.getElementById("p3_files").files || []);
        const images = files.filter(f => f.type.startsWith("image/"));
        const videos = files.filter(f => f.type.startsWith("video/"));
        if (images.length > MAX_PHOTOS) { setMsg("p3","error", `ç…§ç‰‡æœ€å¤š ${MAX_PHOTOS} å¼µ`); return; }
        if (videos.length > 1) { setMsg("p3","error", "å½±ç‰‡æœ€å¤š 1 æ®µ"); return; }

        // convert to base64
        const fileObjs = [];
        for (const f of files){
          const b64 = await fileToBase64(f);
          fileObjs.push({
            name: f.name,
            mime: f.type || "application/octet-stream",
            size: f.size,
            base64: b64
          });
        }
        payload.files = fileObjs;

        // POST åˆ° WebAppï¼ˆç¤¾å€é‚£å¥—å°±æ˜¯é€™æ¨£åšï¼‰
        const resp = await fetch(API_BASE, {
          method: "POST",
          headers: { "Content-Type":"application/json" },
          body: JSON.stringify(payload)
        });

        // æœ‰äº›ç’°å¢ƒå¯èƒ½æ‹¿ä¸åˆ° CORS responseï¼Œä½†å¤šæ•¸ Apps Script WebApp å…¶å¯¦å¯è®€
        let json = null;
        try { json = await resp.json(); } catch(e){}

        if (json && json.ok){
          setMsg("p3","ok", `é€å‡ºæˆåŠŸï¼ç¶­ä¿®å–®ï¼š${json.repair_id || "â€”"}`);
          // è‡ªå‹•å¸¶å…¥æŸ¥è©¢ï¼šç”¨åºè™ŸæŸ¥æœ€è¿‘ç´€éŒ„
          document.getElementById("p4_sn").value = payload.serial_no;
          await p4SearchBySN();
          return;
        }

        // fallbackï¼šå¦‚æœè®€ä¸åˆ° responseï¼Œå°±æ”¹ç”¨åºè™ŸæŸ¥ï¼ˆæœ€å¤šè¼ªè©¢å¹¾æ¬¡ï¼‰
        setMsg("p3","", "å·²é€å‡ºï¼ˆç­‰å¾…å¯«å…¥å®Œæˆï¼‰â€¦æ­£åœ¨ç”¨åºè™Ÿè‡ªå‹•æŸ¥è©¢ç¢ºèª");
        document.getElementById("p4_sn").value = payload.serial_no;
        for (let i=0;i<6;i++){
          await new Promise(r=>setTimeout(r, 600));
          const ok = await p4SearchBySN(true);
          if (ok) { setMsg("p3","ok","é€å‡ºæˆåŠŸï¼ˆå·²åœ¨æŸ¥è©¢å€çœ‹åˆ°æœ€æ–°ç´€éŒ„ï¼‰"); return; }
        }
        setMsg("p3","error","é€å‡ºå¾ŒæŸ¥ä¸åˆ°ç´€éŒ„ï¼šè«‹ç¨å¾Œåˆ°ã€Œç¶­ä¿®æŸ¥è©¢ã€ç”¨åºè™Ÿå†æŸ¥ä¸€æ¬¡ï¼ˆå¯èƒ½æ˜¯ç¶²è·¯æˆ–å¯«å…¥è¼ƒæ…¢ï¼‰");

      }catch(err){
        setMsg("p3","error","é€å‡ºå¤±æ•—ï¼š" + (err && err.message ? err.message : String(err)));
      }
    }

    // ====== p4ï¼šç¶­ä¿®æŸ¥è©¢ï¼ˆ3å€‹å…¥å£ï¼šå€åŸŸ / å‹è™Ÿ / åºè™Ÿï¼‰=====
    function driveViewUrl(fileId){
      return `https://drive.google.com/uc?export=view&id=${encodeURIComponent(fileId)}`;
    }
    function driveOpenUrl(fileId){
      return `https://drive.google.com/file/d/${encodeURIComponent(fileId)}/view`;
    }

    async function p4SearchByRegion(){
      const region = document.getElementById("p4_region").value;
      setMsg("p4","", "æŸ¥è©¢ä¸­â€¦");
      const url = API_BASE + "?" + qs({ action:"repair_query", by:"region", region });
      const res = await jsonp(url);
      if (!res.ok) { setMsg("p4","error", res.msg || "æŸ¥è©¢å¤±æ•—"); return false; }
      renderRepairRows_(res.rows || []);
      setMsg("p4","ok", `æŸ¥è©¢å®Œæˆï¼š${(res.rows||[]).length} ç­†`);
      return true;
    }

    async function p4SearchByModel(){
      const model = document.getElementById("p4_model").value.trim();
      if (!model){ setMsg("p4","error","è«‹è¼¸å…¥å‹è™Ÿ"); return false; }
      setMsg("p4","", "æŸ¥è©¢ä¸­â€¦");
      const url = API_BASE + "?" + qs({ action:"repair_query", by:"model", model });
      const res = await jsonp(url);
      if (!res.ok) { setMsg("p4","error", res.msg || "æŸ¥è©¢å¤±æ•—"); return false; }
      renderRepairRows_(res.rows || []);
      setMsg("p4","ok", `æŸ¥è©¢å®Œæˆï¼š${(res.rows||[]).length} ç­†`);
      return true;
    }

    async function p4SearchBySN(silent){
      const sn = document.getElementById("p4_sn").value.trim();
      if (!sn){ if(!silent) setMsg("p4","error","è«‹è¼¸å…¥åºè™Ÿ"); return false; }
      if (!silent) setMsg("p4","", "æŸ¥è©¢ä¸­â€¦");
      const url = API_BASE + "?" + qs({ action:"repair_query", by:"sn", sn });
      const res = await jsonp(url);
      if (!res.ok) { if(!silent) setMsg("p4","error", res.msg || "æŸ¥è©¢å¤±æ•—"); return false; }
      renderRepairRows_(res.rows || []);
      if(!silent) setMsg("p4","ok", `æŸ¥è©¢å®Œæˆï¼š${(res.rows||[]).length} ç­†`);
      return (res.rows||[]).length > 0;
    }

    function renderRepairRows_(rows){
      const tbody = document.querySelector("#p4_tbl tbody");
      if (!rows.length){
        tbody.innerHTML = `<tr><td colspan="9" style="color:#5b6b85;">æŸ¥ç„¡è³‡æ–™</td></tr>`;
        return;
      }

      tbody.innerHTML = rows.map(r=>{
        const files = Array.isArray(r.files) ? r.files : [];
        const imgs = files.filter(x => (x.mime||"").startsWith("image/"));
        const vids = files.filter(x => (x.mime||"").startsWith("video/"));

        const thumbs = imgs.slice(0,5).map(f=>{
          const u = driveViewUrl(f.id);
          const a = driveOpenUrl(f.id);
          return `<a class="thumb" href="${a}" target="_blank" title="${esc(f.name||"")}"><img src="${u}" alt=""></a>`;
        }).join("");

        const videoLink = vids.length
          ? `<div style="margin-top:8px;"><a href="${driveOpenUrl(vids[0].id)}" target="_blank" class="pill">ğŸ¬ å½±ç‰‡ï¼š${esc(vids[0].name||"é–‹å•Ÿ")}</a></div>`
          : "";

        return `
          <tr>
            <td style="white-space:nowrap;font-weight:900;">${esc(r.repair_id||"â€”")}</td>
            <td>${esc(r.receive_date||"â€”")}</td>
            <td>${esc(r.region||"â€”")}</td>
            <td>${esc(r.item_type||"â€”")}</td>
            <td>${esc(r.product_code||"â€”")}<div style="color:#5b6b85;font-size:12px;margin-top:4px;">${esc(r.model_no||"")}</div></td>
            <td>${esc(r.serial_no||"â€”")}</td>
            <td>${esc(r.customer||"â€”")}<div style="color:#5b6b85;font-size:12px;margin-top:4px;">ç¶­ä¿®å–®ï¼š${esc(r.repair_no||"")}</div></td>
            <td>${esc(r.engineer||"â€”")}</td>
            <td>
              <div class="pill">${esc(r.status||"â€”")}</div>
              <div class="thumbs" style="margin-top:10px;">${thumbs || ""}</div>
              ${videoLink}
            </td>
          </tr>
        `;
      }).join("");
    }
  </script>
</head>

<body>
  <header class="topbar">
    <div class="wrap">
      <div>
        <div class="brand-title">TECOMï½œå¤–è³¼å“ç”¢å“ / å‚™å“æŸ¥è©¢ç³»çµ±ï¼ˆç¶­ä¿®äººå“¡å°ˆç”¨ï¼‰</div>
      </div>
    </div>
  </header>

  <div class="page">
    <aside class="sidebar">
      <nav class="menu" id="menu">
        <button class="active" data-panel="p1">ç”¢å“æ–™è™Ÿ / å‹è™ŸæŸ¥è©¢</button>
        <button data-panel="p2">ç”¢å“åºè™Ÿ / MAC æŸ¥è©¢</button>
        <button data-panel="p3">ç¶­ä¿®å›å ±ï¼ˆå«ä¸Šå‚³ï¼‰</button>
        <button data-panel="p4">ç¶­ä¿®æŸ¥è©¢ï¼ˆå€åŸŸ/å‹è™Ÿ/åºè™Ÿï¼‰</button>
        <button data-panel="p5">ç›£æ§æ”å½±æ©Ÿå‚™å“æŸ¥è©¢</button>
      </nav>

      <div class="hint">
        æœ¬é ç‚ºç¶­ä¿®å‚™å“æŸ¥è©¢å·¥å…·ï¼ˆGitHub Pages å‰ç«¯ + Apps Script APIï¼‰ã€‚<br/>
        ä¸Šå‚³æª”æ¡ˆæœƒå­˜å…¥æŒ‡å®š Drive è³‡æ–™å¤¾ï¼ŒæŸ¥è©¢é æœƒé¡¯ç¤ºç¸®åœ–ã€‚
      </div>
    </aside>

    <main class="main">
      <!-- p1 -->
      <section class="card panel active" id="p1">
        <div class="bar" data-bar>ç”¢å“æ–™è™Ÿ / å‹è™ŸæŸ¥è©¢</div>
        <div class="body">
          <div class="grid">
            <div>
              <label>è¼¸å…¥æ–™è™Ÿï¼ˆproduct_code æˆ– ERP æ–™è™Ÿï¼‰</label>
              <input id="p1_code" placeholder="ä¾‹ï¼š271-001022R æˆ– 671-502633R æˆ– S99XXA0102" />
            </div>
            <div>
              <label>è¼¸å…¥å‹è™Ÿï¼ˆmodel_noï¼‰</label>
              <input id="p1_model" placeholder="ä¾‹ï¼šTE-XSC0A051-N" />
            </div>
            <div>
              <button class="btn" onclick="realSearch('p1')">æŸ¥è©¢</button>
            </div>
          </div>

          <div class="msg" id="p1_msg">è«‹è¼¸å…¥ä»»ä¸€æ¬„ä½å†æŸ¥è©¢ã€‚</div>

          <div class="section-title">æŸ¥è©¢çµæœå¦‚ä¸‹ï¼š</div>
          <div class="kv" id="p1_kv">
            <div class="k">ç”¢å“æ–™è™Ÿ</div><div class="v">â€”</div>
            <div class="k">ç”¢å“å‹è™Ÿ</div><div class="v">â€”</div>
            <div class="k">ä¾›æ‡‰å•†è™Ÿ</div><div class="v">â€”</div>
            <div class="k">ä¸­æ–‡åç¨±</div><div class="v">â€”</div>
            <div class="k">å‚™è¨»</div><div class="v">â€”</div>
          </div>

          <div class="section-title">ç¶­ä¿®å‚™å“è³‡è¨Šï¼š</div>
          <table id="p1_tbl">
            <thead>
              <tr>
                <th style="width:120px;">é …ç›®</th>
                <th>æ–™è™Ÿ</th>
                <th>å‹è™Ÿ</th>
                <th>èªªæ˜</th>
                <th>å‚™è¨»</th>
                <th style="width:90px;">åº«å­˜</th>
              </tr>
            </thead>
            <tbody>
              <tr><td colspan="6" style="color:#5b6b85;">å°šæœªæŸ¥è©¢</td></tr>
            </tbody>
          </table>

          <div class="footer-note">æœƒé¡¯ç¤º ProductMaster + ProductBOM + åº«å­˜ï¼ˆä¸»æ¿/é›»æº/å‚™å“ï¼‰çµæœã€‚</div>
        </div>
      </section>

      <!-- p2 -->
      <section class="card panel" id="p2">
        <div class="bar" data-bar>ç”¢å“åºè™Ÿ / MAC æŸ¥è©¢</div>
        <div class="body">
          <div class="grid">
            <div>
              <label>è¼¸å…¥åºè™Ÿï¼ˆserial_noï¼‰</label>
              <input id="p2_sn" placeholder="ä¾‹ï¼šRP3C00095..." />
            </div>
            <div>
              <label>è¼¸å…¥ MACï¼ˆé¸å¡«ï¼‰</label>
              <input id="p2_mac" placeholder="ä¾‹ï¼š00:11:22:33:44:55" />
            </div>
            <div>
              <button class="btn" onclick="realSearch('p2')">æŸ¥è©¢</button>
            </div>
          </div>

          <div class="msg" id="p2_msg">å¯ç”¨åºè™ŸæŸ¥ï¼šå‡ºè²¨å®¢æˆ¶ / å‡ºè²¨æ—¥æœŸ / å‹è™Ÿ / MAC / P2Pã€‚</div>

          <div class="section-title">æŸ¥è©¢çµæœå¦‚ä¸‹ï¼š</div>
          <div class="kv" id="p2_kv">
            <div class="k">åºè™Ÿ</div><div class="v">â€”</div>
            <div class="k">å‹è™Ÿ</div><div class="v">â€”</div>
            <div class="k">å‡ºè²¨æ—¥æœŸ</div><div class="v">â€”</div>
            <div class="k">å‡ºè²¨å®¢æˆ¶</div><div class="v">â€”</div>
            <div class="k">å‡ºè²¨å–®è™Ÿ</div><div class="v">â€”</div>
            <div class="k">MAC</div><div class="v">â€”</div>
            <div class="k">P2P</div><div class="v">â€”</div>
          </div>
        </div>
      </section>

      <!-- p3 -->
      <section class="card panel" id="p3">
        <div class="bar" data-bar>ç¶­ä¿®å›å ±ï¼ˆå«ä¸Šå‚³ï¼‰</div>
        <div class="body">
          <div class="two-col">
            <div>
              <label>ç¶­ä¿®é …ç›®ï¼ˆä¸‹æ‹‰ï¼‰</label>
              <select id="p3_item_type">
                <option value="é¡æ¯”æ”å½±æ©Ÿ">é¡æ¯”æ”å½±æ©Ÿ</option>
                <option value="ç¶²è·¯æ”å½±æ©Ÿ">ç¶²è·¯æ”å½±æ©Ÿ</option>
                <option value="XVR">XVR</option>
                <option value="NVR" selected>NVR</option>
                <option value="POE SWITCH">POE SWITCH</option>
              </select>
            </div>
            <div>
              <label>å€åŸŸï¼ˆä¸‹æ‹‰ï¼‰</label>
              <select id="p3_region">
                <option value="åŒ—" selected>åŒ—</option>
                <option value="ä¸­">ä¸­</option>
                <option value="å—">å—</option>
                <option value="æ–°ç«¹">æ–°ç«¹</option>
              </select>
            </div>
          </div>

          <div class="two-col" style="margin-top:10px;">
            <div>
              <label>æ–™è™Ÿï¼ˆå¿…å¡«ï¼‰</label>
              <input id="p3_product_code" placeholder="ä¾‹ï¼š671-502606R" />
            </div>
            <div style="display:flex; gap:10px; align-items:end;">
              <div style="flex:1;">
                <label>å‹è™Ÿï¼ˆç”±æ–™è™Ÿå¸¶å‡ºï¼‰</label>
                <input id="p3_model_no" placeholder="æœƒè‡ªå‹•å¸¶å‡º" readonly />
              </div>
              <button class="btn2" onclick="p3LookupModel()">å¸¶å‡ºå‹è™Ÿ</button>
            </div>
          </div>

          <div class="two-col" style="margin-top:10px;">
            <div>
              <label>ç”¢å“åºè™Ÿï¼ˆå¿…å¡«ï¼‰</label>
              <input id="p3_serial_no" placeholder="ä¾‹ï¼šRP3E01165..." />
            </div>
            <div>
              <label>ç¶­ä¿®å–®è™Ÿï¼ˆé¸å¡«ï¼‰</label>
              <input id="p3_repair_no" placeholder="ä¾‹ï¼šRMA-xxxxx æˆ– å®¢æˆ¶å–®è™Ÿ" />
            </div>
          </div>

          <div class="two-col" style="margin-top:10px;">
            <div>
              <label>é€ä¿®å®¢æˆ¶ï¼ˆé¸å¡«ï¼‰</label>
              <input id="p3_customer" placeholder="ä¾‹ï¼šXXç§‘æŠ€ / ç¶“éŠ·å•† / å°ˆæ¡ˆåç¨±" />
            </div>
            <div>
              <label>è² è²¬å·¥ç¨‹å¸«ï¼ˆä¸‹æ‹‰ï¼‰</label>
              <select id="p3_engineer">
                <option value="æ°¸å¯Œ" selected>æ°¸å¯Œ</option>
                <option value="è³œéƒ">è³œéƒ</option>
                <option value="è³œç¦">è³œç¦</option>
                <option value="ç…Œè‰¯">ç…Œè‰¯</option>
              </select>
            </div>
          </div>

          <div class="two-col" style="margin-top:10px;">
            <div>
              <label>æ”¶ä»¶æ—¥æœŸï¼ˆå¿…å¡«/é è¨­ä»Šå¤©ï¼‰</label>
              <input id="p3_receive_date" type="date" />
            </div>
            <div>
              <label>å¯„å›æ–°ç«¹æ—¥æœŸï¼ˆé¸å¡«ï¼‰</label>
              <input id="p3_ship_date" type="date" />
            </div>
          </div>

          <div style="margin-top:10px;">
            <label>ç¶­ä¿®åŸå› èªªæ˜ï¼ˆå¿…å¡«ï¼‰</label>
            <textarea id="p3_issue" placeholder="è«‹æè¿°æ•…éšœç‹€æ³ã€æ˜¯å¦å¯é‡ç¾ã€ç™¼ç”Ÿé »ç‡..."></textarea>
          </div>

          <div style="margin-top:10px;">
            <label>ç›®å‰è™•ç†æ–¹å¼ï¼ˆé¸å¡«ï¼‰</label>
            <textarea id="p3_action" placeholder="ä¾‹ï¼šæ›´æ›ä¸»æ¿ã€å‡ç´šéŸŒé«”ã€å·²å¯„å›æ–°ç«¹å¾…æª¢..."></textarea>
          </div>

          <div class="two-col" style="margin-top:10px;">
            <div>
              <label>ç‹€æ…‹ï¼ˆOPEN / CLOSEDï¼‰</label>
              <select id="p3_status">
                <option value="OPEN" selected>OPEN</option>
                <option value="CLOSED">CLOSED</option>
              </select>
            </div>
            <div>
              <label>ä¸Šå‚³ç…§ç‰‡/å½±ç‰‡ï¼ˆç…§ç‰‡æœ€å¤š 5 å¼µï¼›å½±ç‰‡æœ€å¤š 1 æ®µä¸” < 1 åˆ†é˜ï¼‰</label>
              <input id="p3_files" type="file" multiple accept="image/*,video/*" onchange="p3PreviewFiles()" />
            </div>
          </div>

          <div id="p3_preview" class="thumbs"></div>

          <div style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
            <button class="btn" onclick="p3Submit()">é€å‡ºå›å ±ï¼ˆå«ä¸Šå‚³ï¼‰</button>
            <button class="btn2" onclick="p3Clear()">æ¸…ç©ºé‡å¡«</button>
          </div>

          <div class="msg" id="p3_msg">å¡«å¥½å¾ŒæŒ‰ã€Œé€å‡ºå›å ±ã€ï¼Œç…§ç‰‡/å½±ç‰‡æœƒå­˜åˆ°æŒ‡å®š Drive è³‡æ–™å¤¾ï¼ŒæŸ¥è©¢é å¯çœ‹åˆ°ç¸®åœ–ã€‚</div>
        </div>
      </section>

      <!-- p4 -->
      <section class="card panel" id="p4">
        <div class="bar" data-bar>ç¶­ä¿®æŸ¥è©¢ï¼ˆå€åŸŸ/å‹è™Ÿ/åºè™Ÿï¼‰</div>
        <div class="body">
          <div class="section-title">æŸ¥è©¢ï¼ˆ3 å€‹å…¥å£ï¼‰</div>

          <div class="grid">
            <div>
              <label>ä¾å€åŸŸæŸ¥è©¢ï¼ˆåˆ—å‡ºè©²å€å…¨éƒ¨ç¶­ä¿®å–®ï¼‰</label>
              <select id="p4_region">
                <option value="åŒ—" selected>åŒ—</option>
                <option value="ä¸­">ä¸­</option>
                <option value="å—">å—</option>
                <option value="æ–°ç«¹">æ–°ç«¹</option>
              </select>
            </div>
            <div>
              <label>ä¾å‹è™ŸæŸ¥è©¢ï¼ˆåˆ—å‡ºè©²å‹è™Ÿå…¨éƒ¨ç¶­ä¿®å–®ï¼‰</label>
              <input id="p4_model" placeholder="ä¾‹ï¼šTE-XSC0A051-N / TE-IPB..." />
            </div>
            <div style="display:flex; gap:10px;">
              <button class="btn2" onclick="p4SearchByRegion()">æŸ¥å€åŸŸ</button>
              <button class="btn2" onclick="p4SearchByModel()">æŸ¥å‹è™Ÿ</button>
            </div>
          </div>

          <div class="grid" style="grid-template-columns: 1fr auto; margin-top:10px;">
            <div>
              <label>ä¾ç”¢å“åºè™ŸæŸ¥è©¢ï¼ˆåŒä¸€å°ä¹‹æ‰€æœ‰ç¶­ä¿®ç´€éŒ„ï¼‰</label>
              <input id="p4_sn" placeholder="ä¾‹ï¼šRP3E01165..." />
            </div>
            <div>
              <button class="btn2" onclick="p4SearchBySN()">æŸ¥åºè™Ÿ</button>
            </div>
          </div>

          <div class="msg" id="p4_msg">æŸ¥è©¢å¾Œæœƒé¡¯ç¤ºç¸®åœ–ï¼ˆé»ç¸®åœ–å¯é–‹æª”æ¡ˆï¼‰ã€‚</div>

          <div class="section-title">ç¶­ä¿®ç´€éŒ„æ¸…å–®</div>
          <table id="p4_tbl">
            <thead>
              <tr>
                <th style="width:110px;">repair_id</th>
                <th style="width:110px;">æ”¶ä»¶æ—¥</th>
                <th style="width:70px;">å€åŸŸ</th>
                <th style="width:110px;">ç¶­ä¿®é …ç›®</th>
                <th>æ–™è™Ÿ / å‹è™Ÿ</th>
                <th>åºè™Ÿ</th>
                <th style="width:160px;">å®¢æˆ¶ / ç¶­ä¿®å–®</th>
                <th style="width:90px;">å·¥ç¨‹å¸«</th>
                <th style="width:260px;">ç‹€æ…‹ / åœ–ç‰‡</th>
              </tr>
            </thead>
            <tbody>
              <tr><td colspan="9" style="color:#5b6b85;">å°šæœªæŸ¥è©¢</td></tr>
            </tbody>
          </table>

          <div class="footer-note">
            ä½ èªªçš„ã€ŒDrive ä¸å…¬é–‹ã€ï¼šé€™è£¡ä¸æœƒé¡¯ç¤ºè³‡æ–™å¤¾é€£çµï¼Œåªæœƒç”¨ fileId é¡¯ç¤ºç¸®åœ–èˆ‡æª”æ¡ˆé€£çµã€‚
          </div>
        </div>
      </section>

      <!-- p5 -->
      <section class="card panel" id="p5">
        <div class="bar" data-bar>ç›£æ§æ”å½±æ©Ÿå‚™å“æŸ¥è©¢</div>
        <div class="body">
          <div class="grid">
            <div>
              <label>è¼¸å…¥æ”å½±æ©Ÿæ–™è™Ÿ / å‹è™Ÿ</label>
              <input id="p5_q" placeholder="ä¾‹ï¼š671-502616R æˆ– TE-IPB60505F36-MWI" />
            </div>
            <div></div>
            <div>
              <button class="btn" onclick="realSearch('p5')">æŸ¥è©¢</button>
            </div>
          </div>

          <div class="msg" id="p5_msg">æŸ¥è©¢å¾Œé¡¯ç¤ºæ”å½±æ©Ÿå°æ‡‰å‚™å“èˆ‡åº«å­˜ã€‚</div>

          <div class="section-title">å‚™å“æ¸…å–®ï¼š</div>
          <table id="p5_tbl">
            <thead>
              <tr>
                <th style="width:140px;">æ”å½±æ©Ÿ</th>
                <th>å‚™å“æ–™è™Ÿ</th>
                <th>å‚™å“å‹è™Ÿ</th>
                <th>èªªæ˜</th>
                <th>å‚™è¨»</th>
                <th style="width:90px;">åº«å­˜</th>
              </tr>
            </thead>
            <tbody>
              <tr><td colspan="6" style="color:#5b6b85;">å°šæœªæŸ¥è©¢</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <footer style="max-width:1200px;margin:0 auto 28px;padding:0 18px;">
    <div style="
      background:#ffffff;
      border:1px solid #d7e2f3;
      border-radius:14px;
      padding:12px 14px;
      color:#5b6b85;
      font-size:12.5px;
      box-shadow:0 6px 16px rgba(15,23,42,.06);
    ">
      æœ¬æŸ¥è©¢é åƒ…ä¾› CCTVï¼PoE Switch å¤–è³¼å“ç¶­ä¿®å‚™å“æŸ¥è©¢ä½¿ç”¨ã€‚è‹¥ç³»çµ±ç¨‹å¼æœ‰ä»»ä½•å•é¡Œï¼Œè«‹æ´½åˆ†æ©Ÿ 2216ï¼ˆå®‰å®‰ï¼‰ã€‚
    </div>
  </footer>
</body>
</html>
